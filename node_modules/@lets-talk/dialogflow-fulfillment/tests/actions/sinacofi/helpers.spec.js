const helpers = require("./../../../src/actions/sinacofi/helpers");
const constants = require("./constants");


describe("getReturnCode", () => {
    it("returns correct code", () => {
        const expectation = "10000";
        const code = helpers.extractReturnCode(constants.mockedResponse);
        expect(code).toEqual(expectation);
    });

    it("returns correct code for response from identity check when valid", () => {
        const expectation = "10000";
        const code = helpers.extractReturnCode(constants.mockedResponseIdentityCheckValid);
        expect(code).toEqual(expectation);
    });

    it("returns correct code for response from identity check when invalid", () => {
        const expectation = "10001";
        const code = helpers.extractReturnCode(constants.mockedResponseIdentityCheckInvalid);
        expect(code).toEqual(expectation);
    });
});

describe("extractQuestions", () => {
    it("returns correct questions", () => {
        const questions = helpers.extractQuestions(constants.mockedResponse);
        expect(questions).toEqual(constants.expectedQuestions);
    });
});

describe("extractChallengeId", () => {
    it("returns correct challenge id", () => {
        const expectation = "202012061400070966499828";
        const result = helpers.extractChallengeId(constants.mockedResponse);
        expect(result).toEqual(expectation);
    })
});

describe("prepareQuestion", () => {
    it("returns expected string", () => {
        const message = helpers.prepareNthQuestion(constants.expectedQuestions, 1);
        const expectedMessage = "¿A Qué Sucursal de la Región Metropolitana fue este mes de Mayo?\n\n1 - Sucursal CUPRUM Conchali, Santiago\n2 - Sucursal CUPRUM Est. central, Santiago\n3 - Sucursal CUPRUM Lo prado, Santiago\n4 - Sucursal CUPRUM La cisterna, Santiago";
        expect(message).toEqual(expectedMessage);
    })
});