const { JWT } = require('google-auth-library');
const { getJWTClient } = require("./../../src/services/google_auth");

jest.mock('google-auth-library');


describe("getJWTClient", () => {
    const params = {
        df_client_email: "test@test.com",
        df_private_key: "soPrivate",
    }
    beforeEach(() => {
        JWT.mockClear();
    });

    it("creates class with correct parameters", () => {
        getJWTClient(params);
        expect(JWT).toHaveBeenCalledWith(
            params.df_client_email,
            null,
            params.df_private_key,
            ['https://www.googleapis.com/auth/cloud-platform'],
        )
    });

    it("returns a JWT client", () => {
        const res = getJWTClient(params);
        expect(res).toBeInstanceOf(JWT);
    })
})


